import csv



# Notkun: hlutfoll = villuhlutfoll(folderpath)
# Fyrir: folderpath er slóðin að althingi_errors möppunni
# Eftir:  hlutfoll er dictionary af hlutfallslegum fjölda villna í althingi_errors skránum.
#       hlutfoll[79] gefur hlutfall villna í 079.csv, hlutfoll[110] gefur hlutfall villna í 110.csv 
#       Meðalfjöldi villna hefur líka verið skrifaður út
#       hlutfall = fjöldi rangra orða / fjöldi orða

def villuhlutfoll(folder):
    
    missing = [83, 86,87, 88,98,104, 109]
    villuhlutfoll = []

    for i in [x for x in range(79,100) if x not in missing]:

        with open(folder + '0' + str(i) + '.csv', encoding = 'utf-8') as errorfile:
            reader = csv.reader(errorfile)
            nerrors = 0
            nrow = 0
            villuradir = []
            for row in reader:
                # það eru nerrors villur í fyrstu nrow röðunum í errorfile og þær eru í villuradir[0..nerrors]
                if nrow > 0 and (row[0]!=row[3]): # sleppa að telja headerinn
                    nerrors += 1
                    villuradir.append(nrow)
                nrow += 1
            villuhlutfoll.append(nerrors/nrow)

    for i in [x for x in range(100,111) if x not in missing]:
    
        with open(folder  + str(i) + '.csv', encoding = 'utf-8') as errorfile:
            reader = csv.reader(errorfile)
            nerrors = 0
            nrow = 0
            villuradir = []
            for row in reader:
                # það eru nerrors villur í fyrstu nrow röðunum í errorfile og þær eru í villuradir[0..nerrors]
                if nrow > 0 and (row[0]!=row[3]): # sleppa að telja headerinn
                    nerrors += 1
                    villuradir.append(nrow)
                nrow += 1
            villuhlutfoll.append(nerrors/nrow)
            
    print("meðalfjöldi villna:")
    print(sum(villuhlutfoll)/len(villuhlutfoll))

    j = 0
    dicto = dict()
    x = [i for i in range(79,111) if i not in missing]

    for i in x:
        dicto[i] = villuhlutfoll[j]
        j += 1
        
        
    return dicto


hlutfoll = villuhlutfoll('C:\\Users\\EggertÞór\\Documents\\Skólinn\\Reiknigreind\\Project 2\\althingi_errors\\')
missing = [83, 86,87, 88,98,104, 109]
x = [i for i in range(79,111) if i not in missing]

for i in x:
    print("Hlutfallsvillur í skrá #:")
    print(i, hlutfoll[i])
