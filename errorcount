import csv

# Skrifar út villuhlutfall fyrir althingi_errors skrárnar
# krefst þess að kallað sé á villuhlutfoll með réttri slóð á althingi_errors

# Notkun: hlutfoll = villuhlutfoll(folderpath)
# Fyrir: folderpath er slóðin að althingi_errors möppunni
# Eftir:  hlutfoll er listi af hlutfallslegum fjölda villna í althingi_errors skránum. hlutfoll[0] er fyrir 079.csv, hlutfoll[1] fyrir 080.csv o.s.frv.
#       Meðalfjöldi villna hefur verið skrifaður út

def villuhlutfoll(folder):
    
    missing = [83, 86,87, 88,98,104, 109]
    villuhlutfoll = []

    for i in [x for x in range(79,99) if x not in missing]:

        with open(folder + '0' + str(i) + '.csv', encoding = 'utf-8') as errorfile:
            reader = csv.reader(errorfile)
            nerrors = 0
            nrow = 0
            villuradir = []
            for row in reader:
                # það eru nerrors villur í fyrstu nrow röðunum í errorfile og þær eru í villuradir[0..nerrors]
                if nrow > 0 and (row[0]!=row[3]): # sleppa að telja headerinn
                    nerrors += 1
                    villuradir.append(nrow)
                nrow += 1

            villuhlutfoll.append(nerrors/nrow)

    for i in [x for x in range(100,111) if x not in missing]:
    
        with open(folder  + str(i) + '.csv', encoding = 'utf-8') as errorfile:
            reader = csv.reader(errorfile)
            nerrors = 0
            nrow = 0
            villuradir = []
            for row in reader:
                # það eru nerrors villur í fyrstu nrow röðunum í errorfile og þær eru í villuradir[0..nerrors]
                if nrow > 0 and (row[0]!=row[3]): # sleppa að telja headerinn
                    nerrors += 1
                    villuradir.append(nrow)
                nrow += 1

            villuhlutfoll.append(nerrors/nrow)
            
    print("meðalfjöldi villna:")
    print(sum(villuhlutfoll)/len(villuhlutfoll))
    return villuhlutfoll


hlutfoll = villuhlutfoll('C:\\Users\\EggertÞór\\Documents\\Skólinn\\Reiknigreind\\Project 2\\althingi_errors\\')
missing = [83, 86,87, 88,98,104, 109]
j = 0
for i in [x for x in range(79,111) if x not in missing]:
    print("Hlutfallsvillur í skrá nr. " + str(i))
    print(hlutfoll[j])
    j += 1
